<!DOCTYPE html>
<html lang="pl">
<head>
    <link rel="stylesheet" href="assets/index.css">
    <link rel="icon" type="image/x-icon"
        href="https://play-lh.googleusercontent.com/_TNbiYKasPy_isTSEg2_UEzVaev4F8fO2lLunsHJ8_Ux2g3OzkSZyzpqvJG1woSj-WD4=w240-h480-rw">
    <title>mObywatel</title>
    <meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">
</head>

<body>
    <script>
if (localStorage.getItem("loggedIn") !== "true") {
    window.location.href = "lajon.html";
}
</script>  
    <img src="https://play-lh.googleusercontent.com/_TNbiYKasPy_isTSEg2_UEzVaev4F8fO2lLunsHJ8_Ux2g3OzkSZyzpqvJG1woSj-WD4"
        class="logo">
    <p class="logo_text">uname</p>

    <div class="guide_holder">
        <div class="top_holder">
            <p class="guide_title">Instrukcja</p>
            <img class="arrow" src="https://i.imgur.com/aUZmu0W.png">
        </div>
        <div class="guide_text">
            <span style="font-size: 17px; font-weight: 500;">Dla systemu IOS:</span><br>
            <ul>
                <li>Upewnij się, że używasz przeglądarki Safari</li>
                <li>Uzupełnij dane i kliknij wejdź</li>
                <li>Naciśnij „Udostępnij” → „Do ekranu głównego”</li>
            </ul>
            <span style="font-size: 17px; font-weight: 500;">Dla systemu Android:</span>
            <ul>
                <li>Upewnij się, że używasz przeglądarki Google Chrome</li>
                <li>Uzupełnij dane i kliknij wejdź</li>
                <li>Naciśnij 3 kropki → „Dodaj do ekranu głównego”</li>
            </ul>
        </div>
    </div>

    <div class="upload">
        <p class="error">To pole jest wymagane</p>

        <div class="upload_grid">
            <img class="upload_image" id="preview" src="https://i.imgur.com/vwIQErh.png">
            <p class="upload_text">Wklej link z Imgur</p>
        </div>

        <input type="text" id="imgurLink" class="input" placeholder="https://i.imgur.com/TwojeZdjecie.jpg" style="margin-top: 10px; width: 100%;">
    </div>

    <div class="input_holder"><input type="text" id="name" class="input"><span class="placeholder">Imię (imiona)</span></div>
    <div class="input_holder"><input type="text" id="surname" class="input"><span class="placeholder">Nazwisko</span></div>
    <div class="input_holder"><input type="text" id="sex" class="input"><span class="placeholder">Płeć</span></div>
    <div class="input_holder"><input type="text" id="nationality" class="input"><span class="placeholder">Obywatelstwo</span></div>
    <div class="input_holder"><input type="text" id="birthday" class="input"><span class="placeholder">Data urodzenia (DD.MM.YYYY)</span></div>
    <div class="input_holder"><input type="text" id="familyName" class="input"><span class="placeholder">Nazwisko rodowe</span></div>
    <div class="input_holder"><input type="text" id="fathersFamilyName" class="input"><span class="placeholder">Nazwisko rodowe ojca</span></div>
    <div class="input_holder"><input type="text" id="mothersFamilyName" class="input"><span class="placeholder">Nazwisko rodowe matki</span></div>

    <p class="subtext">Miejsce zamieszkania</p>

    <div class="input_holder"><input type="text" id="birthPlace" class="input"><span class="placeholder">Miejsce urodzenia</span></div>
    <div class="input_holder"><input type="text" id="countryOfBirth" class="input"><span class="placeholder">Kraj urodzenia</span></div>
    <div class="input_holder"><input type="text" id="adress1" class="input"><span class="placeholder">Ulica i numer domu</span></div>
    <div class="input_holder"><input type="text" id="adress2" class="input"><span class="placeholder">Kod pocztowy</span></div>
    <div class="input_holder"><input type="text" id="city" class="input"><span class="placeholder">Miasto</span></div>
    <div class="input_holder"><input type="text" id="checkInDate" class="input"><span class="placeholder">Data zameldowania (DD.MM.YYYY)</span></div>

    <a class="go" id="goBtn">wejdź</a>

    <script>
        const imgurInput = document.getElementById('imgurLink');
        const preview = document.getElementById('preview');
        const goBtn = document.getElementById('goBtn');

        function isValidImgur(link) {
            if (!link) return false;
            link = link.trim();
            return link.startsWith('https://i.imgur.com/') && (
                link.endsWith('.jpg') || link.endsWith('.jpeg') ||
                link.endsWith('.png') || link.endsWith('.gif')
            );
        }

        imgurInput.addEventListener('input', () => {
            const link = imgurInput.value.trim();
            if (isValidImgur(link)) preview.src = link;
        });

        const params = new URLSearchParams(window.location.search);
        let photo = params.get('photo');

        if (photo) {
            photo = decodeURIComponent(photo);
            if (isValidImgur(photo)) {
                imgurInput.value = photo;
                preview.src = photo;
            }
        }

        goBtn.addEventListener('click', () => {
            const fields = [
                "name", "surname", "sex", "nationality", "birthday",
                "familyName", "fathersFamilyName", "mothersFamilyName",
                "birthPlace", "countryOfBirth", "adress1", "adress2",
                "city", "checkInDate"
            ];

            const newParams = new URLSearchParams();

            fields.forEach(f => {
                const val = document.getElementById(f).value.trim();
                if (val) newParams.append(f, val);
            });

            const photoLink = imgurInput.value.trim();
            if (isValidImgur(photoLink)) newParams.append('photo', photoLink);

            window.location.href = `card.html?${newParams.toString()}`;
        });
function decode(str) {
    return atob(str);
}

const encryptedPassword = "bWVmYWFkbWluYQ==";
const storageKey = btoa("username"); 


const checkBtn = document.getElementById('checkUserBtn');
const modal = document.getElementById('userModal');
const closeModal = document.getElementById('closeModal');
const submitPassword = document.getElementById('submitPassword');
const modalPassword = document.getElementById('modalPassword');
const modalError = document.getElementById('modalError');
const userInfo = document.getElementById('userInfo');

checkBtn.addEventListener('click', () => {
    modal.style.display = "flex";
    modalPassword.value = "";
    modalError.style.display = "none";
    userInfo.style.display = "none";
});

closeModal.addEventListener('click', () => {
    modal.style.display = "none";
});

submitPassword.addEventListener('click', () => {
    const val = modalPassword.value;
    if(val === decode(encryptedPassword)) {
        const username = localStorage.getItem(atob(storageKey)) || 'Nieznany';
        userInfo.innerHTML = `<strong>Zalogowany użytkownik:</strong> ${username}`;
        userInfo.style.display = "block";
        modalError.style.display = "none";
    } else {
        modalError.style.display = "block";
        userInfo.style.display = "none";
    }
});

window.addEventListener('click', (e) => {
    if(e.target === modal) modal.style.display = "none";
});  
    </script>
<button onclick="logout()" style="position: fixed; top: 15px; right: 15px; background: #ff4d4d; color: white; border: none; border-radius: 6px; padding: 8px 14px; cursor: pointer; z-index:9999;">Wyloguj</button>
<script>
function logout(){ localStorage.removeItem('loggedIn'); window.location.href='lajon.html' }
</script>
<button id="checkUserBtn" style="
    position: fixed;
    bottom: 15px;
    right: 15px;
    background: #007bff;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px 14px;
    cursor: pointer;
    z-index:9999;
">Sprawdź użytkownika</button>

<div id="userModal" style="
    display:none;
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.6);
    justify-content:center;
    align-items:center;
    z-index:10000;
">
  <div style="
      background:#1e1e2f;
      padding: 20px;
      border-radius: 12px;
      width: 300px;
      text-align:center;
      color:white;
      position: relative;
  ">
    <h3>Podaj hasło</h3>
    <input type="password" id="modalPassword" placeholder="Hasło" style="width: 100%; padding: 8px; margin-top: 10px; border-radius: 6px; border:none;">
    <p id="modalError" style="color:red; font-size:12px; margin-top:5px; display:none;">Niepoprawne hasło!</p>
    <button id="submitPassword" style="
        margin-top: 10px;
        padding: 8px 14px;
        border:none;
        border-radius:6px;
        background:#00ff9f;
        color:#000;
        font-weight:600;
        cursor:pointer;
    ">Pokaż użytkownika</button>
    <button id="closeModal" style="
        position: absolute;
        top: 10px;
        right: 12px;
        background:transparent;
        border:none;
        color:white;
        font-size:18px;
        cursor:pointer;
    ">&times;</button>
    <div id="userInfo" style="margin-top: 15px; display:none; font-size:14px;"></div>
  </div>
</div>
<script>
function decode(str) {
    return atob(str);
}

const encryptedPassword = "bWVmYWFkbWluYQ=="; 
const storageKey = btoa("username"); 

const checkBtn = document.getElementById('checkUserBtn');
const modal = document.getElementById('userModal');
const closeModal = document.getElementById('closeModal');
const submitPassword = document.getElementById('submitPassword');
const modalPassword = document.getElementById('modalPassword');
const modalError = document.getElementById('modalError');
const userInfo = document.getElementById('userInfo');

checkBtn.addEventListener('click', () => {
    modal.style.display = "flex";
    modalPassword.value = "";
    modalError.style.display = "none";
    userInfo.style.display = "none";
});

closeModal.addEventListener('click', () => {
    modal.style.display = "none";
});

submitPassword.addEventListener('click', () => {
    const val = modalPassword.value;
    if(val === decode(encryptedPassword)) {
        const username = localStorage.getItem(atob(storageKey)) || 'Nieznany';
        userInfo.innerHTML = `<strong>Zalogowany użytkownik:</strong> ${username}`;
        userInfo.style.display = "block";
        modalError.style.display = "none";
    } else {
        modalError.style.display = "block";
        userInfo.style.display = "none";
    }
});

window.addEventListener('click', (e) => {
    if(e.target === modal) modal.style.display = "none";
});
</script>


</body>
</html>






